<?xml version="1.0" encoding="UTF-8" ?>
 <!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.demo.dao.MemberDao">

	<!-- 회원가입 -->
	<insert id="logininsert" parameterType="member">
		insert into member
		values(#{memail},#{mpw},#{mname},#{mphone},#{mage},#{mgender},#{maddress},#{mcareer},
		#{meducation},#{mmajor},#{mcertification},#{mlang},#{mdb},sysdate(),default)
	</insert>

	<!-- 로그인 -->
	<select id="dbselectone" resultType="member">
		select * from
		member where
		memail = #{memail} and mdrop = 'N'
	</select>

	<!-- 회원수정 -->
	<update id="updatemember" parameterType="member">
		update member set
		memail=#{memail},
		mpw=#{mpw},
		mname=#{mname},
		mphone=#{mphone},
		mage=#{mage},
		mgender=#{mgender},
		maddress=#{maddress},
		mcareer=#{mcareer},
		meducation=#{meducation},
		mmajor=#{mmajor},
		mcertification=#{mcertification},
		mlang=#{mlang},
		mdb=#{mdb},
		mreg=sysdate(),
		mdrop= default
		where memail=#{memail}
	</update>

	<!-- 회원탈퇴 -->
	<update id="deletemember" parameterType="member">
		update member set mdrop
		= 'Y' where memail = #{memail}
	</update>

	<!-- memail 리뷰 가져오기 -->
	<select id="selectreview" resultType="review" parameterType="map">
		SELECT *
		FROM review
		WHERE memail = #{memail} AND rdrop = 'N'
		ORDER BY rreg DESC
		LIMIT #{start}, 10;
	</select>
	
	<!-- 리뷰 갯수 -->
	<select id="reviewcount" resultType="int">
		select count(*) from review
		where rconfirm = 'N' and rdrop = 'N'
	</select>
	
	<!-- memail qna 가져오기 -->
	<select id="qnaselect" resultType="qna" parameterType="map">
		select * from qna where memail = #{memail} and qdrop = 'N'
		ORDER BY qreg DESC
		LIMIT #{start}, 10;
	</select>
	
	<!-- qna 페이징 -->
	<select id="qnacount" resultType="int">
		select count(*) from qna
		where qdrop = 'N'
	</select>
	
	<!-- feedback 페이징 -->
	<select id="fbcount" resultType="int">
		select count(*) from feedback where fdrop = 'N'
	</select>
	
	<!-- memail feedback 가져오기 -->
	<select id="fbselect" resultType="feedback" parameterType="map">
		select * from feedback where memail = #{memail} and fdrop = 'N'
		order by freg desc 
		limit #{start}, 10;
	</select>
	
	<!-- 커뮤니티 페이징 -->
	<select id="ccount" resultType="int">
		select count(*) from community where cdrop = 'N'
	</select>
	
	<!-- 커뮤니티 가져오기  -->
	<select id="cselect" resultType="community" parameterType="map">
		select * from community where memail = #{memail} and cdrop = 'N'
		order by creg desc 
		limit #{start}, 10;
	</select>

</mapper>
